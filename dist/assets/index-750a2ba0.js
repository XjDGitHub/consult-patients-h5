import{e as fe,u as ne,L as Ie,P as De,m as Me,d as Ye}from"./request-2770c0b0.js";import{c as O,t as k,n as Q,a as y,u as $e,U as de,a1 as me,a2 as Ee,V as Xe,v as he,T as ce,X as K,p as G,a3 as R,w as ge,b as ze,D as V,a4 as Ze,H as Ae,f as re,m as ue,h as He,A as Ne,a0 as Re,I as ke,r as ye,e as We}from"./index-30acc300.js";import{d as p,r as T,D as ee,m as P,G as H,v as se,O as _e,N as Be,K as Fe,c as x,H as le,q as we}from"./index-1f5bf9e6.js";import{I as Le}from"./index-e4f90eff.js";import{c as Ue}from"./interceptor-42f26492.js";const[Ce,j]=O("swipe"),qe={loop:k,width:Q,height:Q,vertical:Boolean,autoplay:y(0),duration:y(500),touchable:k,lazyRender:Boolean,initialSwipe:y(0),indicatorColor:String,showIndicators:k,stopPropagation:k},Pe=Symbol(Ce);var Ke=p({name:Ce,props:qe,emits:["change","dragStart","dragEnd"],setup(e,{emit:v,slots:m}){const t=T(),s=T(),o=ee({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let I=!1;const w=fe(),{children:g,linkChildren:u}=$e(Pe),n=P(()=>g.length),f=P(()=>o[e.vertical?"height":"width"]),C=P(()=>e.vertical?w.deltaY.value:w.deltaX.value),b=P(()=>o.rect?(e.vertical?o.rect.height:o.rect.width)-f.value*n.value:0),X=P(()=>f.value?Math.ceil(Math.abs(b.value)/f.value):n.value),z=P(()=>n.value*f.value),D=P(()=>(o.active+n.value)%n.value),N=P(()=>{const i=e.vertical?"vertical":"horizontal";return w.direction.value===i}),r=P(()=>{const i={transitionDuration:`${o.swiping?0:e.duration}ms`,transform:`translate${e.vertical?"Y":"X"}(${o.offset}px)`};if(f.value){const h=e.vertical?"height":"width",d=e.vertical?"width":"height";i[h]=`${z.value}px`,i[d]=e[d]?`${e[d]}px`:""}return i}),Z=i=>{const{active:h}=o;return i?e.loop?R(h+i,-1,n.value):R(h+i,0,X.value):h},M=(i,h=0)=>{let d=i*f.value;e.loop||(d=Math.min(d,-b.value));let Y=h-d;return e.loop||(Y=R(Y,b.value,0)),Y},A=({pace:i=0,offset:h=0,emitChange:d})=>{if(n.value<=1)return;const{active:Y}=o,S=Z(i),L=M(S,h);if(e.loop){if(g[0]&&L!==b.value){const oe=L<b.value;g[0].setOffset(oe?z.value:0)}if(g[n.value-1]&&L!==0){const oe=L>0;g[n.value-1].setOffset(oe?-z.value:0)}}o.active=S,o.offset=L,d&&S!==Y&&v("change",D.value)},W=()=>{o.swiping=!0,o.active<=-1?A({pace:n.value}):o.active>=n.value&&A({pace:-n.value})},te=()=>{W(),w.reset(),K(()=>{o.swiping=!1,A({pace:-1,emitChange:!0})})},F=()=>{W(),w.reset(),K(()=>{o.swiping=!1,A({pace:1,emitChange:!0})})};let U;const a=()=>clearTimeout(U),c=()=>{a(),+e.autoplay>0&&n.value>1&&(U=setTimeout(()=>{F(),c()},+e.autoplay))},l=(i=+e.initialSwipe)=>{if(!t.value)return;const h=()=>{var d,Y;if(!ce(t)){const S={width:t.value.offsetWidth,height:t.value.offsetHeight};o.rect=S,o.width=+((d=e.width)!=null?d:S.width),o.height=+((Y=e.height)!=null?Y:S.height)}n.value&&(i=Math.min(n.value-1,i),i===-1&&(i=n.value-1)),o.active=i,o.swiping=!0,o.offset=M(i),g.forEach(S=>{S.setOffset(0)}),c()};ce(t)?le().then(h):h()},$=()=>l(o.active);let E;const _=i=>{!e.touchable||i.touches.length>1||(w.start(i),I=!1,E=Date.now(),a(),W())},ae=i=>{e.touchable&&o.swiping&&(w.move(i),N.value&&(!e.loop&&(o.active===0&&C.value>0||o.active===n.value-1&&C.value<0)||(G(i,e.stopPropagation),A({offset:C.value}),I||(v("dragStart",{index:D.value}),I=!0))))},q=()=>{if(!e.touchable||!o.swiping)return;const i=Date.now()-E,h=C.value/i;if((Math.abs(h)>.25||Math.abs(C.value)>f.value/2)&&N.value){const Y=e.vertical?w.offsetY.value:w.offsetX.value;let S=0;e.loop?S=Y>0?C.value>0?-1:1:0:S=-Math[C.value>0?"ceil":"floor"](C.value/f.value),A({pace:S,emitChange:!0})}else C.value&&A({pace:0});I=!1,o.swiping=!1,v("dragEnd",{index:D.value}),c()},xe=(i,h={})=>{W(),w.reset(),K(()=>{let d;e.loop&&i===n.value?d=o.active===0?0:i:d=i%n.value,h.immediate?K(()=>{o.swiping=!1}):o.swiping=!1,A({pace:d-o.active,emitChange:!0})})},be=(i,h)=>{const d=h===D.value,Y=d?{backgroundColor:e.indicatorColor}:void 0;return x("i",{style:Y,class:j("indicator",{active:d})},null)},Se=()=>{if(m.indicator)return m.indicator({active:D.value,total:n.value});if(e.showIndicators&&n.value>1)return x("div",{class:j("indicators",{vertical:e.vertical})},[Array(n.value).fill("").map(be)])};return ne({prev:te,next:F,state:o,resize:$,swipeTo:xe}),u({size:f,props:e,count:n,activeIndicator:D}),H(()=>e.initialSwipe,i=>l(+i)),H(n,()=>l(o.active)),H(()=>e.autoplay,c),H([de,me,()=>e.width,()=>e.height],$),H(Ee(),i=>{i==="visible"?c():a()}),se(l),_e(()=>l(o.active)),Xe(()=>l(o.active)),Be(a),Fe(a),he("touchmove",ae,{target:s}),()=>{var i;return x("div",{ref:t,class:j()},[x("div",{ref:s,style:r.value,class:j("track",{vertical:e.vertical}),onTouchstartPassive:_,onTouchend:q,onTouchcancel:q},[(i=m.default)==null?void 0:i.call(m)]),Se()])}}});const Ve=ge(Ke),[je,Ge]=O("swipe-item");var Je=p({name:je,setup(e,{slots:v}){let m;const t=ee({offset:0,inited:!1,mounted:!1}),{parent:s,index:o}=ze(Pe);if(!s)return;const I=P(()=>{const u={},{vertical:n}=s.props;return s.size.value&&(u[n?"height":"width"]=`${s.size.value}px`),t.offset&&(u.transform=`translate${n?"Y":"X"}(${t.offset}px)`),u}),w=P(()=>{const{loop:u,lazyRender:n}=s.props;if(!n||m)return!0;if(!t.mounted)return!1;const f=s.activeIndicator.value,C=s.count.value-1,b=f===0&&u?C:f-1,X=f===C&&u?0:f+1;return m=o.value===f||o.value===b||o.value===X,m}),g=u=>{t.offset=u};return se(()=>{le(()=>{t.mounted=!0})}),ne({setOffset:g}),()=>{var u;return x("div",{class:Ge(),style:I.value},[w.value?(u=v.default)==null?void 0:u.call(v):null])}}});const Qe=ge(Je),ve=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),ie=O("image-preview")[1];var Te=p({props:{src:String,show:Boolean,active:Number,minZoom:V(Q),maxZoom:V(Q),rootWidth:V(Number),rootHeight:V(Number),disableZoom:Boolean},emits:["scale","close","longPress"],setup(e,{emit:v,slots:m}){const t=ee({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,imageRatio:0,displayWidth:0,displayHeight:0}),s=fe(),o=T(),I=P(()=>{const{rootWidth:a,rootHeight:c}=e,l=c/a;return t.imageRatio>l}),w=P(()=>{const{scale:a,moveX:c,moveY:l,moving:$,zooming:E}=t,_={transitionDuration:E||$?"0s":".3s"};if(a!==1){const ae=c/a,q=l/a;_.transform=`scale(${a}, ${a}) translate(${ae}px, ${q}px)`}return _}),g=P(()=>{if(t.imageRatio){const{rootWidth:a,rootHeight:c}=e,l=I.value?c/t.imageRatio:a;return Math.max(0,(t.scale*l-a)/2)}return 0}),u=P(()=>{if(t.imageRatio){const{rootWidth:a,rootHeight:c}=e,l=I.value?c:a*t.imageRatio;return Math.max(0,(t.scale*l-c)/2)}return 0}),n=a=>{a=R(a,+e.minZoom,+e.maxZoom+1),a!==t.scale&&(t.scale=a,v("scale",{scale:a,index:e.active}))},f=()=>{n(1),t.moveX=0,t.moveY=0},C=()=>{const a=t.scale>1?1:2;n(a),t.moveX=0,t.moveY=0};let b,X,z,D,N,r,Z,M=!1;const A=a=>{const{touches:c}=a;if(b=c.length,b===2&&e.disableZoom)return;const{offsetX:l}=s;s.start(a),X=t.moveX,z=t.moveY,Z=Date.now(),M=!1,t.moving=b===1&&t.scale!==1,t.zooming=b===2&&!l.value,t.zooming&&(D=t.scale,N=ve(a.touches))},W=a=>{const{touches:c}=a;if(s.move(a),t.moving){const{deltaX:l,deltaY:$}=s,E=l.value+X,_=$.value+z;if((E>g.value||E<-g.value)&&!M&&s.isHorizontal()){t.moving=!1;return}M=!0,G(a,!0),t.moveX=R(E,-g.value,g.value),t.moveY=R(_,-u.value,u.value)}if(t.zooming&&(G(a,!0),c.length===2)){const l=ve(c),$=D*l/N;n($)}},te=()=>{if(b>1)return;const{offsetX:a,offsetY:c}=s,l=Date.now()-Z,$=250,E=5;a.value<E&&c.value<E&&(l<$?r?(clearTimeout(r),r=null,C()):r=setTimeout(()=>{v("close"),r=null},$):l>Ze&&v("longPress"))},F=a=>{let c=!1;if((t.moving||t.zooming)&&(c=!0,t.moving&&X===t.moveX&&z===t.moveY&&(c=!1),!a.touches.length)){t.zooming&&(t.moveX=R(t.moveX,-g.value,g.value),t.moveY=R(t.moveY,-u.value,u.value),t.zooming=!1),t.moving=!1,X=0,z=0,D=1,t.scale<1&&f();const l=+e.maxZoom;t.scale>l&&(t.scale=l)}G(a,c),te(),s.reset()},U=a=>{const{naturalWidth:c,naturalHeight:l}=a.target;t.imageRatio=l/c};return H(()=>e.active,f),H(()=>e.show,a=>{a||f()}),he("touchmove",W,{target:P(()=>{var a;return(a=o.value)==null?void 0:a.$el})}),()=>{const a={loading:()=>x(Ie,{type:"spinner"},null)};return x(Qe,{ref:o,class:ie("swipe-item"),onTouchstartPassive:A,onTouchend:F,onTouchcancel:F},{default:()=>[m.image?x("div",{class:ie("image-wrap")},[m.image({src:e.src})]):x(Le,{src:e.src,fit:"contain",class:ie("image",{vertical:I.value}),style:w.value,onLoad:U},a)]})}}});const[Oe,B]=O("image-preview"),pe=["show","teleport","transition","overlayStyle","closeOnPopstate"],et={show:Boolean,loop:k,images:Ae(),minZoom:y(1/3),maxZoom:y(3),overlay:k,closeable:Boolean,showIndex:k,className:re,closeIcon:ue("clear"),transition:String,beforeClose:Function,overlayClass:re,overlayStyle:Object,swipeDuration:y(300),startPosition:y(0),showIndicators:Boolean,closeOnPopstate:k,closeIconPosition:ue("top-right"),teleport:[String,Object]};var tt=p({name:Oe,props:et,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:v,slots:m}){const t=T(),s=ee({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),o=()=>{if(t.value){const r=Ne(t.value.$el);s.rootWidth=r.width,s.rootHeight=r.height,t.value.resize()}},I=r=>v("scale",r),w=r=>v("update:show",r),g=()=>{Ue(e.beforeClose,{args:[s.active],done:()=>w(!1)})},u=r=>{r!==s.active&&(s.active=r,v("change",r))},n=()=>{if(e.showIndex)return x("div",{class:B("index")},[m.index?m.index({index:s.active}):`${s.active+1} / ${e.images.length}`])},f=()=>{if(m.cover)return x("div",{class:B("cover")},[m.cover()])},C=()=>{s.disableZoom=!0},b=()=>{s.disableZoom=!1},X=()=>x(Ve,{ref:t,lazyRender:!0,loop:e.loop,class:B("swipe"),duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:u,onDragEnd:b,onDragStart:C},{default:()=>[e.images.map((r,Z)=>x(Te,{src:r,show:e.show,active:s.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:s.rootWidth,rootHeight:s.rootHeight,disableZoom:s.disableZoom,onScale:I,onClose:g,onLongPress:()=>v("longPress",{index:Z})},{image:m.image}))]}),z=()=>{if(e.closeable)return x(ke,{role:"button",name:e.closeIcon,class:[B("close-icon",e.closeIconPosition),Re],onClick:g},null)},D=()=>v("closed"),N=(r,Z)=>{var M;return(M=t.value)==null?void 0:M.swipeTo(r,Z)};return ne({swipeTo:N}),se(o),H([de,me],o),H(()=>e.startPosition,r=>u(+r)),H(()=>e.show,r=>{const{images:Z,startPosition:M}=e;r?(u(+M),le(()=>{o(),N(+M,{immediate:!0})})):v("close",{index:s.active,url:Z[s.active]})}),()=>x(De,we({class:[B(),e.className],overlayClass:[B("overlay"),e.overlayClass],onClosed:D,"onUpdate:show":w},He(e,pe)),{default:()=>[z(),X(),n(),f()]})}});let J;const at={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeIconPosition:"top-right"};function ot(){({instance:J}=Me({setup(){const{state:e,toggle:v}=Ye(),m=()=>{e.images=[]};return()=>x(tt,we(e,{onClosed:m,"onUpdate:show":v}),null)}}))}const mt=(e,v=0)=>{if(ye)return J||ot(),e=Array.isArray(e)?{images:e,startPosition:v}:e,J.open(We({},at,e)),J};var it=(e=>(e[e.Doctor=1]="Doctor",e[e.Fast=2]="Fast",e[e.Medication=3]="Medication",e))(it||{}),nt=(e=>(e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.HalfYear=3]="HalfYear",e[e.More=4]="More",e))(nt||{}),st=(e=>(e[e.MsgText=1]="MsgText",e[e.MsgImage=4]="MsgImage",e[e.CardPat=21]="CardPat",e[e.CardPre=22]="CardPre",e[e.CardEvaForm=23]="CardEvaForm",e[e.CardEva=24]="CardEva",e[e.Notify=31]="Notify",e[e.NotifyTip=32]="NotifyTip",e[e.NotifyCancel=33]="NotifyCancel",e))(st||{}),lt=(e=>(e[e.NotPayment=1]="NotPayment",e[e.Payment=2]="Payment",e[e.Invalid=3]="Invalid",e))(lt||{}),ct=(e=>(e[e.ConsultPay=1]="ConsultPay",e[e.ConsultWait=2]="ConsultWait",e[e.ConsultChat=3]="ConsultChat",e[e.ConsultComplete=4]="ConsultComplete",e[e.ConsultCancel=5]="ConsultCancel",e[e.MedicinePay=10]="MedicinePay",e[e.MedicineSend=11]="MedicineSend",e[e.MedicineTake=12]="MedicineTake",e[e.MedicineComplete=13]="MedicineComplete",e[e.MedicineCancel=14]="MedicineCancel",e))(ct||{});export{it as C,nt as I,st as M,ct as O,lt as P,Ve as S,Qe as a,mt as s};
