import{_ as D}from"./CpPaySheet-dc9b8950.js";import{_ as M}from"./CpNavBar-7cf3a7ed.js";import{g as V,a as A,c as N}from"./order-d77b653c.js";import{d as j,r as n,v as R,a as b,b as g,c as e,e as a,t as i,w,h as T,j as U,p as q,k as E,_ as F}from"./index-1f5bf9e6.js";import{O as G}from"./OrderMedical-9e01af11.js";import{a as f}from"./request-2770c0b0.js";import{I as L}from"./index-30acc300.js";import{C as z}from"./index-5432fdfe.js";import{C as H}from"./index-35da296c.js";import{C as J}from"./index-09f3a16d.js";import{S as K}from"./index-39807dd2.js";import{S as Q}from"./index-079ddc50.js";import"./CpIcon-ef85b36d.js";import"./consult-8ddc6603.js";import"./index-f227a669.js";import"./use-route-e787040d.js";import"./use-placeholder-d6a25d3e.js";import"./interceptor-42f26492.js";const y=c=>(q("data-v-4d6bbcfe"),c=c(),E(),c),W={key:0,class:"order-pay-page"},X={class:"order-address"},Y={class:"area"},Z={class:"detail"},ee={class:"order-medical"},ae=y(()=>a("div",{class:"head"},[a("h3",null,"优医药房"),a("small",null,"优医质保 假一赔十")],-1)),te={class:"order-detail"},oe={class:"order-tip"},se=y(()=>a("p",{class:"tip"}," 由于药品的特殊性，如非错发、漏发药品的情况，药品一经发出 不得退换，请核对药品信息无误后下单。 ",-1)),le=y(()=>a("a",{href:"javascript:;"},"支付协议",-1)),re={key:1,class:"order-pay-page"},ne=j({__name:"OrderPay",setup(c){const x=U(),t=n(),k=async()=>{const l=await V({prescriptionId:x.query.id});t.value=l.data},o=n(),I=async()=>{const l=await A();if(l.data.length){const s=l.data.find(r=>r.isDefault===0);s?o.value=s:o.value=l.data[0]}};R(()=>{k(),I()});const u=n(!1),p=n(!1),h=n(""),C=async()=>{var l,s;if(!u.value)return f("请同意支付协议");if(!((l=o.value)!=null&&l.id))return f("请选择收货地址");if(!((s=t.value)!=null&&s.id))return f("未找到处方");try{p.value=!0;const r=await N({id:t.value.id,addressId:o.value.id,couponId:t.value.couponId});h.value=r.data.id,p.value=!1,_.value=!0}catch{p.value=!1}},_=n(!1);return(l,s)=>{const r=M,P=L,d=z,S=H,O=J,$=D,B=K,m=Q;return t.value&&o.value?(b(),g("div",W,[e(r,{title:"药品支付"}),a("div",X,[a("p",Y,[e(P,{name:"location"}),a("span",null,i(o.value.province+o.value.city+o.value.county),1)]),a("p",Z,i(o.value.addressDetail),1),a("p",null,i(o.value.receiver)+" "+i(o.value.mobile.replace(/^(\d{3})\d+(\d{4})$/,"$1****$2")),1)]),a("div",ee,[ae,e(G,{medicines:t.value.medicines},null,8,["medicines"])]),a("div",te,[e(S,null,{default:w(()=>[e(d,{title:"药品金额",value:`￥${t.value.payment}`},null,8,["value"]),e(d,{title:"运费",value:`￥${t.value.expressFee}`},null,8,["value"]),e(d,{title:"优惠券",value:`-￥${t.value.couponDeduction}`},null,8,["value"]),e(d,{title:"实付款",value:`￥${t.value.actualPayment}`,class:"price"},null,8,["value"])]),_:1})]),a("div",oe,[se,e(O,{"model-value":u.value,"onUpdate:modelValue":s[0]||(s[0]=v=>u.value=v)},{default:w(()=>[T("我已同意"),le]),_:1},8,["model-value"])]),e($,{show:_.value,"onUpdate:show":s[1]||(s[1]=v=>_.value=v),"pay-callback":"order/pay/result","order-id":h.value,"actual-payment":t.value.actualPayment},null,8,["show","order-id","actual-payment"]),e(B,{price:t.value.actualPayment*100,"button-text":"立即支付","button-type":"primary","text-align":"left",onClick:C},null,8,["price"])])):(b(),g("div",re,[e(r,{title:"药品支付"}),e(m,{title:"",avatar:"",row:"2",style:{"margin-top":"15px"}}),e(m,{title:"",row:"4",style:{"margin-top":"50px"}}),e(m,{title:"",row:"4",style:{"margin-top":"50px"}})]))}}});const Pe=F(ne,[["__scopeId","data-v-4d6bbcfe"]]);export{Pe as default};
